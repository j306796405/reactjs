{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;IAEqB,O;;;;;;;;;;6CACI;AAAA,gBACZ,MADY,GACF,KAAK,KAAL,CAAW,QAAX,CAAoB,KADlB,CACZ,MADY;;AAEjB,gBAAI,MAAJ,EAAY,KAAK,KAAL,CAAW,aAAX,CAAyB,MAAzB;AACZ,iBAAK,aAAL;AACH;;;;;;;;;kDAMyB,S,EAAW;;AAEjC,gBAAI,UAAU,QAAV,CAAmB,MAAnB,KAA8B,KAAK,KAAL,CAAW,QAAX,CAAoB,MAAtD,EAA8D;AAC1D,uBAAO,KAAK,KAAL,CAAW,aAAX,CAAyB,UAAU,QAAV,CAAmB,KAAnB,CAAyB,MAAlD,CAAP;AACH;;AAED,gBAAM,qBAAqB,UAAU,GAAV,CAAc,cAAzC;AACA,gBACI,yBAAe,kBAAf,MACA,yBAAe,KAAK,KAAL,CAAW,GAAX,CAAe,cAA9B,CAFJ,EAGE;;AAEF,iBAAK,aAAL,CAAmB,kBAAnB;AACH;;;wCAE6D;AAAA,gBAAhD,cAAgD,yDAA/B,KAAK,KAAL,CAAW,GAAX,CAAe,cAAgB;AAAA,gBACrD,OADqD,GACP,cADO,CACrD,OADqD;AAAA,gBAC5C,QAD4C,GACP,cADO,CAC5C,QAD4C;AAAA,gBACjB,MADiB,GACP,cADO,CAClC,eADkC;;AAE1D,iBAAK,KAAL,CAAW,QAAX,CAAoB,EAAC,gBAAD,EAAU,kBAAV,EAAoB,cAApB,EAApB;AACH;;;iCAEQ;AACL,oBAAQ,GAAR,CAAY,KAAK,KAAjB;AADK,yBAMD,KAAK,KANJ;AAAA,oCAGD,GAHC;AAAA,gBAGK,IAHL,cAGK,IAHL;AAAA,gBAGW,cAHX,cAGW,cAHX;AAAA,gBAG4B,QAH5B,UAG4B,QAH5B;AAAA,gBAID,MAJC,UAID,MAJC;AAAA,gBAIO,UAJP,UAIO,UAJP;AAAA,gBAImB,UAJnB,UAImB,UAJnB;AAAA,gBAKD,cALC,UAKD,cALC;AAAA,gBAKe,mBALf,UAKe,mBALf;;;AAQL,mBACI;AAAA;gBAAA;gBACI;AACI,6BAAS,KAAK;AADlB,mBAEQ,cAFR;AAGI,gCAAY,UAHhB;AAII,gCAAY,UAJhB,IADJ;gBAOM,CAAC,KAAK,MAAN,IAAgB,wDAPtB;gBASI;AACI,6BAAS,KAAK;AADlB,mBAEQ,cAFR;AAGI,oCAAgB,cAHpB;AAII,yCAAqB,mBAJzB,IATJ;gBAeI;AAAA;oBAAA,EAAI,WAAU,YAAd;oBACM,KAAK,GAAL,CAAS;AAAA,+BACH;AAAA;4BAAA,EAAI,WAAU,iBAAd,EAAgC,KAAK,IAAI,EAAzC;4BACI;AAAA;gCAAA,EAAM,qBAAmB,IAAI,EAA7B;gCACI;AAAA;oCAAA;oCAAK,IAAI;AAAT;AADJ,6BADJ;4BAII;AAAA;gCAAA,EAAM,WAAU,OAAhB;gCACd,iCAAkB,IAAI,IAAtB,EAA4B,CAA5B;AADc,6BAJJ;4BAOI,yCAPJ;4BAQI;AAAA;gCAAA,EAAM,WAAU,YAAhB;gCAAA;AAAA,6BARJ;4BASI;AAAA;gCAAA,EAAM,qBAAmB,IAAI,MAA7B;gCACI;AAAA;oCAAA;oCAAK,IAAI;AAAT;AADJ,6BATJ;4BAaI;AAAA;gCAAA;AACI,2CAAO,IAAI,EADf;AAEI,8CAAU,YAAY,SAAS,QAAT,KAAsB,IAAI,MAFpD;AAGI,4CAAQ,MAHZ;gCAII;AAAA;oCAAA;AACI,mDAAU,cADd;AAEI,6DAAmB,IAAI,EAF3B;oCAAA;AAAA;AAJJ;AAbJ,yBADG;AAAA,qBAAT;AADN;AAfJ,aADJ;AA8CH;;;;;kBArFgB,O","file":"index-compiled.js","sourcesContent":["import React, {Component} from 'react'\r\nimport {Link} from 'react-router'\r\nimport Pagination from './Pagination'\r\nimport NoticeBar from './NoticeBar'\r\nimport DisplayControl from './DisplayControl'\r\nimport OptBtnGroup from 'COMPONENT/Msg/OptBtnGroup'\r\nimport dateTimeFormatter from 'UTIL/dateTimeFormatter'\r\n\r\nexport default class MsgList extends Component {\r\n    componentWillMount() {\r\n        let {author} = this.props.location.query\r\n        if (author) this.props.specifyAuthor(author)\r\n        this.updateMsgList() \r\n    }\r\n\r\n    /**\r\n     * 类似于 Vue 中的 route: { data: Function } 属性，监听路由变化加载数据\r\n     * 【拓展阅读】无限循环坑 http://stackoverflow.com/questions/36189775\r\n     */\r\n    componentWillReceiveProps(nextProps) {\r\n        // query string 变化\r\n        if (nextProps.location.search !== this.props.location.search) {\r\n            return this.props.specifyAuthor(nextProps.location.query.author)\r\n        }\r\n\r\n        const nextDisplayControl = nextProps.msg.displayControl\r\n        if (\r\n            JSON.stringify(nextDisplayControl) ===\r\n            JSON.stringify(this.props.msg.displayControl)\r\n        ) return\r\n\r\n        this.updateMsgList(nextDisplayControl)\r\n    }\r\n\r\n    updateMsgList(displayControl = this.props.msg.displayControl) {\r\n        let {pageIdx, quantity, authorSpecified: author} = displayControl\r\n        this.props.fetchMsg({pageIdx, quantity, author})\r\n    }\r\n\r\n    render() {\r\n        console.log(this.props)\r\n        let {\r\n            msg: {msgs, displayControl}, userData,\r\n            delMsg, goPrevPage, goNextPage,\r\n            changeQuantity, resetDisplayControl\r\n        } = this.props\r\n\r\n        return ( \r\n            <div>\r\n                <Pagination\r\n                    msgsLen={msgs.length}\r\n                    {...displayControl}\r\n                    goPrevPage={goPrevPage}\r\n                    goNextPage={goNextPage}/>\r\n\r\n                { !msgs.length && <NoticeBar /> }\r\n\r\n                <DisplayControl\r\n                    msgsLen={msgs.length}\r\n                    {...displayControl}\r\n                    changeQuantity={changeQuantity}\r\n                    resetDisplayControl={resetDisplayControl}/>\r\n\r\n                <ul className=\"list-group\">\r\n                    { msgs.map(msg =>\r\n                            <li className=\"list-group-item\" key={msg.id}>\r\n                                <Link to={`/msg/detail/${msg.id}`}>\r\n                                    <b>{ msg.title }</b>\r\n                                </Link>\r\n                                <span className=\"badge\">\r\n                { dateTimeFormatter(msg.time, 3) }\r\n              </span>\r\n                                <br/>\r\n                                <span className=\"text-muted\">by&nbsp;</span>\r\n                                <Link to={`/msg?author=${msg.author}`}>\r\n                                    <i>{ msg.author }</i>\r\n                                </Link>\r\n\r\n                                <OptBtnGroup\r\n                                    msgId={msg.id}\r\n                                    isAuthor={userData && userData.username === msg.author}\r\n                                    delMsg={delMsg}>\r\n                                    <Link\r\n                                        className=\"btn btn-info\"\r\n                                        to={`/msg/detail/${msg.id}`}>\r\n                                        查看详情\r\n                                    </Link>\r\n                                </OptBtnGroup>\r\n                            </li>\r\n                    )}\r\n                </ul>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]}